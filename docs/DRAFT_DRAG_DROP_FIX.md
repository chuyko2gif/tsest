# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: Drag & Drop –¥–ª—è —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤

## üêõ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ
- ‚ùå –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è: –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –≤ –ë–î
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω –≤—ã–∑–æ–≤ `reorder_draft_release()` –ø–æ—Å–ª–µ drag & drop

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –õ–∏—à–Ω—è—è –ø—É—Å—Ç–æ—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏  
- ‚ùå –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è: —ç–ª–µ–º–µ–Ω—Ç —Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º, –Ω–æ –∑–∞–Ω–∏–º–∞–ª –º–µ—Å—Ç–æ
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ DOM –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ü–æ—Ä—è–¥–æ–∫ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è
- ‚ùå –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è: —Ä–µ–ª–∏–∑—ã –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –ø–æ `created_at`
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: —á–µ—Ä–Ω–æ–≤–∏–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ `draft_order`

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –º–∏–≥—Ä–∞—Ü–∏—é

–û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª:
\`\`\`
sql/add_draft_ordering_system.sql
\`\`\`

–≠—Ç–æ –¥–æ–±–∞–≤–∏—Ç:
- –ü–æ–ª–µ `draft_order` –≤ –æ–±–µ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–ª–∏–∑–æ–≤
- –§—É–Ω–∫—Ü–∏—é `reorder_draft_release()` –¥–ª—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏
- –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

\`\`\`bash
npm run dev
\`\`\`

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª "–ê—Ä—Ö–∏–≤ (–ß–µ—Ä–Ω–æ–≤–∏–∫–∏)"
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫ –Ω–∞ –Ω–æ–≤–æ–µ –º–µ—Å—Ç–æ
4. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É - –ø–æ—Ä—è–¥–æ–∫ –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è ‚úÖ

## üìù –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –∫–æ–¥–µ

### –ò–∑–º–µ–Ω–µ–Ω—ã —Ñ–∞–π–ª—ã:

1. **app/cabinet/components/UserReleases.tsx**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `reorderDraftInDatabase()` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î
   - –û–±–Ω–æ–≤–ª–µ–Ω `handleDragEnd()` - —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
   - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –æ—Ç–∫–∞—Ç–æ–º –ø—Ä–∏ –æ—à–∏–±–∫–µ

2. **app/cabinet/components/releases/ReleasesGrid.tsx**
   - –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–µ–º—ã–π —ç–ª–µ–º–µ–Ω—Ç –±–æ–ª—å—à–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è (—É–±—Ä–∞–Ω–∞ –ø—É—Å—Ç–æ—Ç–∞)
   - –£—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥: `{draggingReleaseId !== release.id && (<ReleaseCard />)}`

3. **app/cabinet/components/releases/ReleaseCard.tsx**
   - –£–±—Ä–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ `localDragging` 
   - –£–ø—Ä–æ—â–µ–Ω drag & drop –±–µ–∑ –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

4. **app/cabinet/components/releases/hooks.ts**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `draft_order` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
   - –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ —Ç–µ–ø–µ—Ä—å —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: `draft_order` > `created_at`

## ‚ú® –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–ü—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏:**
   - –≠–ª–µ–º–µ–Ω—Ç —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ (–±–µ–∑ –ø—É—Å—Ç–æ—Ç—ã)
   - Placeholder –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—É–¥–∞ —ç–ª–µ–º–µ–Ω—Ç –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–¥–≤–∏–≥–∞—é—Ç—Å—è –ø–ª–∞–≤–Ω–æ

2. **–ü—Ä–∏ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–∏:**
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `reorder_draft_release(id, newPosition, tableType)`
   - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –≤—Å–µ—Ö —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤
   - –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø–æ—Ä—è–¥–æ–∫ (—É–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏)
   - UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑ –ë–î

3. **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:**
   - –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å `.order('draft_order')`
   - –°–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é (1, 2, 3...)
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–ª–∏–∑—ã –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è

## üéØ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –§—É–Ω–∫—Ü–∏—è reorder_draft_release()

\`\`\`typescript
const { error } = await supabase.rpc('reorder_draft_release', {
  p_release_id: 'uuid',        // ID –ø–µ—Ä–µ–º–µ—â–∞–µ–º–æ–≥–æ —Ä–µ–ª–∏–∑–∞
  p_new_position: 3,           // –ù–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è (1-based!)
  p_table_name: 'basic'        // 'basic' –∏–ª–∏ 'exclusive'
});
\`\`\`

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã

- **–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∞:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–≤–∏—Ç—Å—è –≤ –∫–æ–Ω–µ—Ü (`MAX(draft_order) + 1`)
- **–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∞:** –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–Ω—É–º–µ—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è
- **–ü—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:** `draft_order` –æ—á–∏—â–∞–µ—Ç—Å—è (NULL)

## ‚ùó –í–∞–∂–Ω–æ

- –ü–æ–∑–∏—Ü–∏–∏ –≤ –ë–î –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å **1**, –∞ –Ω–µ —Å 0
- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ **—á–µ—Ä–Ω–æ–≤–∏–∫–∏** (status='draft')
- –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü: `releases_basic` –∏ `releases_exclusive`
- –ü—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–∫–∞—Ç UI

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å drag & drop —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- ‚úÖ –ù–µ—Ç –ª–∏—à–Ω–µ–π –ø—É—Å—Ç–æ—Ç—ã
- ‚úÖ –ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- ‚úÖ –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
